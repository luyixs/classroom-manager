{"ast":null,"code":"import Cookies from 'js-cookie';\nimport axios from 'axios';\nexport default {\n  components: {},\n  props: {},\n  data() {\n    return {\n      activeTab: 'register',\n      roleOptions: [{\n        value: 'student',\n        label: '学生'\n      }, {\n        value: 'teacher',\n        label: '教师'\n      }, {\n        value: 'admin',\n        label: '管理员'\n      }],\n      repwd: '',\n      formData: {\n        id: '',\n        name: '',\n        pwd: '',\n        className: '',\n        academy: '',\n        major: '',\n        tel: '',\n        email: '',\n        role: 'student'\n      },\n      sOptions: {\n        academy: ['计算机学院', '艺术学院', '医学院', '理学院'],\n        majors: [{\n          academy: '计算机学院',\n          major: '软件工程'\n        }, {\n          academy: '计算机学院',\n          major: '计算机科学与技术'\n        }, {\n          academy: '计算机学院',\n          major: '人工智能'\n        }, {\n          academy: '理学院',\n          major: '数学与应用数学'\n        }, {\n          academy: '理学院',\n          major: '信息与计算科学'\n        }, {\n          academy: '医学院',\n          major: '临床医学'\n        }, {\n          academy: '医学院',\n          major: '药学'\n        }, {\n          academy: '医学院',\n          major: '口腔医学'\n        }, {\n          academy: '艺术学院',\n          major: '美术学'\n        }, {\n          academy: '艺术学院',\n          major: '视觉传达设计'\n        }],\n        classes: [{\n          major: '软件工程',\n          class: '2022级软件工程1班'\n        }, {\n          major: '软件工程',\n          class: '2022级软件工程2班'\n        }, {\n          major: '软件工程',\n          class: '2022级软件工程3班'\n        }, {\n          major: '计算机科学与技术',\n          class: '2022级计算机科学与技术1班'\n        }, {\n          major: '计算机科学与技术',\n          class: '2022级计算机科学与技术2班'\n        }, {\n          major: '人工智能',\n          class: '2022级人工智能1班'\n        }, {\n          major: '数学与应用数学',\n          class: '数学与应用数学1班'\n        }, {\n          major: '信息与计算科学',\n          class: '信息与计算科学1班'\n        }, {\n          major: '视觉传达设计',\n          class: '2022级视觉传达设计1班'\n        }, {\n          major: '美术学',\n          class: '2022级美术学1班'\n        }, {\n          major: '临床医学',\n          class: '2022级临床医学1班'\n        }, {\n          major: '药学',\n          class: '2022级药学1班'\n        }, {\n          major: '口腔医学',\n          class: '2022级口腔医学1班'\n        }]\n      },\n      academy: '',\n      majors: [],\n      classes: []\n    };\n  },\n  watch: {},\n  computed: {},\n  methods: {\n    handleLogin() {\n      // console.log(this.formData);\n      axios({\n        method: 'POST',\n        url: '/login/',\n        data: {\n          id: this.formData.id,\n          pwd: this.formData.pwd,\n          role: this.formData.role\n        }\n      }).then(rsp => {\n        if (rsp.data.success) {\n          this.$message({\n            message: '登录成功！',\n            type: 'success'\n          });\n          //保存cookie\n          console.log(rsp.data.data);\n          this.setCookie('loginUser', rsp.data.data);\n          //跳转页面\n          this.redirectURL('/index');\n        } else {\n          this.$message(\"登录失败，请检查用户名和密码是否正确\");\n        }\n      }, err => {\n        this.$message.error(err.message);\n      });\n    },\n    handleRegister() {\n      if (this.formData.id == '') {\n        this.$message(\"学号/教工号不能为空\");\n        return;\n      }\n      if (this.repwd != this.formData.pwd) {\n        this.$message(\"两次密码不一致\");\n        return;\n      }\n      console.log(this.formData);\n      //发送请求\n      axios({\n        method: 'post',\n        // baseURL: 'http://localhost:8080/',\n        url: '/login/reg',\n        //提交数据格式为：{user={id='xx',pwd='xx'}}\n        data: {\n          user: this.formData\n        }\n      }).then(rsp => {\n        console.log('rsp:', rsp.data);\n        if (rsp.data.success) {\n          this.$message({\n            message: '添加成功！',\n            type: 'success'\n          });\n          this.activeTab = 'login';\n        } else {\n          this.$message(\"添加失败\");\n        }\n      }, err => {\n        this.$message.error(err.message);\n      }).finally(() => {});\n\n      //提交数据格式为：{id='xx',pwd='xx'}\n      // axios.post('http://localhost:8080/login/reg2',this.formData).then(\n      //     rsp=>{console.log('rsp:',rsp.data)},\n      //     err=>{this.$message(e.message)}\n      // )\n    },\n\n    handleChangeTab(tab, event) {\n      // console.log(tab, event);\n    },\n    academyChange(e) {\n      this.formData.major = ''; //选择一级下拉菜单后先清空二级下拉菜单之前的内容\n      this.formData.className = '';\n      this.majors = this.sOptions.majors.filter(major => {\n        return major.academy == this.formData.academy;\n      });\n    },\n    majorChange() {\n      this.formData.className = '';\n      this.classes = this.sOptions.classes.filter(classItem => {\n        return classItem.major == this.formData.major;\n      });\n    },\n    redirectURL(url) {\n      console.log(url);\n      window.location.href = window.location.origin + url;\n    },\n    setLoginUser() {\n      this.loginUser = this.getCookie('loginUser');\n    },\n    setCookie(key, value) {\n      Cookies.set(key, JSON.stringify(value));\n    },\n    getCookie(key) {\n      // console.log('IndexLogin getCookie 被调用')\n      let cookieValue = Cookies.get(key);\n      if (cookieValue == undefined) {\n        return null; //cookie未定义\n      }\n\n      return JSON.parse(Cookies.get(key));\n    }\n  },\n  created() {},\n  mounted() {}\n};","map":{"version":3,"mappings":"AAqFA;AACA;AACA;EACAA;EACAC;EACAC;IACA;MACAC;MACAC;QAAAC;QAAAC;MAAA;QAAAD;QAAAC;MAAA;QACAD;QACAC;MACA;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;QACAL;QACAM,SACA;UAAAN;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,EACA;QACAM,UACA;UAAAN;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA,GACA;UAAAP;UAAAO;QAAA;MAEA;MACAR;MACAM;MACAC;IACA;EACA;EACAE;EACAC;EACAC;IACAC;MACA;MACAC;QACAC;QACAC;QACA1B;UACAO;UACAE;UACAM;QACA;MACA;QACA;UACA;YAAAY;YAAAC;UAAA;UACA;UACAC;UACA;UACA;UACA;QACA;UACA;QACA;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;QACA;MACA;MACA;QACA;QACA;MACA;MACAD;MACA;MACAL;QACAC;QACA;QACAC;QACA;QACA1B;UACA+B;QACA;MACA;QACAF;QACA;UACA;YACAF;YACAC;UACA;UACA;QACA;UACA;QACA;MACA;QACA;MACA,kBACA;;MAEA;MACA;MACA;MACA;MACA;IACA;;IACAI;MACA;IAAA,CACA;IACAC;MACA;MACA;MACA;QACA;MACA;IACA;IACAC;MACA;MACA;QACA;MACA;IACA;IACAC;MACAN;MACAO;IACA;IAEAC;MACA;IACA;IAEAC;MACAC;IACA;IACAC;MACA;MACA;MACA;QACA;MACA;;MACA;IACA;EACA;EACAC;EACAC;AACA","names":["components","props","data","activeTab","roleOptions","value","label","repwd","formData","id","name","pwd","className","academy","major","tel","email","role","sOptions","majors","classes","class","watch","computed","methods","handleLogin","axios","method","url","message","type","console","handleRegister","user","handleChangeTab","academyChange","majorChange","redirectURL","window","setLoginUser","setCookie","Cookies","getCookie","created","mounted"],"sourceRoot":"src/views/login","sources":["App.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-app\">\r\n    <!-- 登录注册盒子 -->\r\n    <el-card class=\"login-box\">\r\n      <el-tabs v-model=\"activeTab\" @tab-click=\"handleChangeTab\" a>\r\n        <!--登录选项卡-->\r\n        <el-tab-pane label=\"登录\" name=\"login\">\r\n          <h3>登录</h3>\r\n          <el-form ref=\"form\" label-width=\"80px\" :model=\"formData\" action=\"http://localhost:8080\" method=\"post\">\r\n            <el-form-item label=\"ID:\" size=\"medium\">\r\n              <el-input placeholder=\"请输入学号/教工号\" v-model=\"formData.id\" clearable></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"密码:\" size=\"medium\">\r\n              <el-input placeholder=\"请输入密码\" v-model=\"formData.pwd\" show-password></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"身份:\">\r\n              <el-select v-model=\"formData.role\" placeholder=\"请选择\" size=\"mini\" style=\"width: 100px;\">\r\n                <el-option v-for=\"item in roleOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"handleLogin\">登录</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-tab-pane>\r\n        <!--注册选项卡-->\r\n        <el-tab-pane label=\"注册\" name=\"register\">\r\n          <h3>注册</h3>\r\n          <el-form ref=\"form\" label-width=\"80px\" :model=\"formData\" action=\"http://localhost:8080\" method=\"post\">\r\n            <el-form-item label=\"ID:\" size=\"medium\">\r\n              <el-input placeholder=\"请输入学号/教工号\" v-model=\"formData.id\" clearable></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"姓名:\" size=\"medium\">\r\n              <el-input placeholder=\"请输入姓名\" v-model=\"formData.name\" maxlength=\"10\" show-word-limit clearable>\r\n              </el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"密码:\" size=\"medium\">\r\n              <el-input placeholder=\"请输入密码\" v-model=\"formData.pwd\" show-password></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"确认密码:\" size=\"medium\">\r\n              <el-input placeholder=\"请输入密码\" v-model=\"repwd\" show-password></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"班级:\" size=\"medium\">\r\n              <el-select v-model=\"formData.academy\" placeholder=\"院系\" @change=\"academyChange($event)\" size=\"mini\"\r\n                style=\"width: 80px;\">\r\n                <el-option v-for=\"academy in sOptions.academy\" :key=\"academy\" :label=\"academy\" :value=\"academy\">\r\n                </el-option>\r\n              </el-select>\r\n              <el-select v-model=\"formData.major\" placeholder=\"专业\" @change=\"majorChange\" size=\"mini\"\r\n                style=\"width: 80px;\">\r\n                <el-option v-for=\"majorItem in majors\" :key=\"majorItem.major\" :label=\"majorItem.major\"\r\n                  :value=\"majorItem.major\">\r\n                </el-option>\r\n              </el-select>\r\n              <el-select v-model=\"formData.className\" placeholder=\"班级\" @change=\"\" size=\"mini\" style=\"width: 90px;\">\r\n                <el-option v-for=\"classItem in classes\" :key=\"classItem.class\" :label=\"classItem.class\"\r\n                  :value=\"classItem.class\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"电话:\" size=\"medium\">\r\n              <el-input placeholder=\"请输入电话号码\" v-model=\"formData.tel\" clearable></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"邮箱:\" size=\"medium\">\r\n              <el-input placeholder=\"请输入邮箱\" v-model=\"formData.email\" clearable></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"身份:\">\r\n              <el-select v-model=\"formData.role\" placeholder=\"请选择\" size=\"mini\" style=\"width: 100px;\">\r\n                <el-option v-for=\"item in roleOptions\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <el-button type=\"primary\" @click=\"handleRegister\">注册</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </el-tab-pane>\r\n      </el-tabs>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Cookies from 'js-cookie';\r\nimport axios from 'axios';\r\nexport default {\r\n  components: {},\r\n  props: {},\r\n  data() {\r\n    return {\r\n      activeTab: 'register',\r\n      roleOptions: [{ value: 'student', label: '学生' }, { value: 'teacher', label: '教师' }, {\r\n        value: 'admin',\r\n        label: '管理员'\r\n      }],\r\n      repwd: '',\r\n      formData: {\r\n        id: '',\r\n        name: '',\r\n        pwd: '',\r\n        className: '',\r\n        academy: '',\r\n        major: '',\r\n        tel: '',\r\n        email: '',\r\n        role: 'student'\r\n      },\r\n      sOptions: {\r\n        academy: ['计算机学院', '艺术学院', '医学院', '理学院'],\r\n        majors: [\r\n          { academy: '计算机学院', major: '软件工程' },\r\n          { academy: '计算机学院', major: '计算机科学与技术' },\r\n          { academy: '计算机学院', major: '人工智能' },\r\n          { academy: '理学院', major: '数学与应用数学' },\r\n          { academy: '理学院', major: '信息与计算科学' },\r\n          { academy: '医学院', major: '临床医学' },\r\n          { academy: '医学院', major: '药学' },\r\n          { academy: '医学院', major: '口腔医学' },\r\n          { academy: '艺术学院', major: '美术学' },\r\n          { academy: '艺术学院', major: '视觉传达设计' },\r\n        ],\r\n        classes: [\r\n          { major: '软件工程', class: '2022级软件工程1班' },\r\n          { major: '软件工程', class: '2022级软件工程2班' },\r\n          { major: '软件工程', class: '2022级软件工程3班' },\r\n          { major: '计算机科学与技术', class: '2022级计算机科学与技术1班' },\r\n          { major: '计算机科学与技术', class: '2022级计算机科学与技术2班' },\r\n          { major: '人工智能', class: '2022级人工智能1班' },\r\n          { major: '数学与应用数学', class: '数学与应用数学1班' },\r\n          { major: '信息与计算科学', class: '信息与计算科学1班' },\r\n          { major: '视觉传达设计', class: '2022级视觉传达设计1班' },\r\n          { major: '美术学', class: '2022级美术学1班' },\r\n          { major: '临床医学', class: '2022级临床医学1班' },\r\n          { major: '药学', class: '2022级药学1班' },\r\n          { major: '口腔医学', class: '2022级口腔医学1班' },\r\n        ]\r\n      },\r\n      academy: '',\r\n      majors: [],\r\n      classes: [],\r\n    };\r\n  },\r\n  watch: {},\r\n  computed: {},\r\n  methods: {\r\n    handleLogin() {\r\n      // console.log(this.formData);\r\n      axios({\r\n        method: 'POST',\r\n        url: '/login/',\r\n        data: {\r\n          id: this.formData.id,\r\n          pwd: this.formData.pwd,\r\n          role: this.formData.role\r\n        }\r\n      }).then(rsp => {\r\n        if (rsp.data.success) {\r\n          this.$message({ message: '登录成功！', type: 'success' })\r\n          //保存cookie\r\n          console.log(rsp.data.data);\r\n          this.setCookie('loginUser',rsp.data.data)\r\n          //跳转页面\r\n          this.redirectURL('/index')\r\n        } else {\r\n          this.$message(\"登录失败，请检查用户名和密码是否正确\")\r\n        }\r\n      }, err => {\r\n        this.$message.error(err.message)\r\n      })\r\n    },\r\n    handleRegister() {\r\n      if (this.formData.id == '') {\r\n        this.$message(\"学号/教工号不能为空\")\r\n        return\r\n      }\r\n      if (this.repwd != this.formData.pwd) {\r\n        this.$message(\"两次密码不一致\")\r\n        return\r\n      }\r\n      console.log(this.formData);\r\n      //发送请求\r\n      axios({\r\n        method: 'post',\r\n        // baseURL: 'http://localhost:8080/',\r\n        url: '/login/reg',\r\n        //提交数据格式为：{user={id='xx',pwd='xx'}}\r\n        data: {\r\n          user: this.formData\r\n        }\r\n      }).then(rsp => {\r\n        console.log('rsp:', rsp.data)\r\n        if (rsp.data.success) {\r\n          this.$message({\r\n            message: '添加成功！',\r\n            type: 'success'\r\n          });\r\n          this.activeTab = 'login'\r\n        } else {\r\n          this.$message(\"添加失败\")\r\n        }\r\n      }, err => {\r\n        this.$message.error(err.message)\r\n      }).finally(() => {\r\n      })\r\n\r\n      //提交数据格式为：{id='xx',pwd='xx'}\r\n      // axios.post('http://localhost:8080/login/reg2',this.formData).then(\r\n      //     rsp=>{console.log('rsp:',rsp.data)},\r\n      //     err=>{this.$message(e.message)}\r\n      // )\r\n    },\r\n    handleChangeTab(tab, event) {\r\n      // console.log(tab, event);\r\n    },\r\n    academyChange(e) {\r\n      this.formData.major = '' //选择一级下拉菜单后先清空二级下拉菜单之前的内容\r\n      this.formData.className = ''\r\n      this.majors = this.sOptions.majors.filter(major => {\r\n        return major.academy == this.formData.academy\r\n      })\r\n    },\r\n    majorChange() {\r\n      this.formData.className = ''\r\n      this.classes = this.sOptions.classes.filter(classItem => {\r\n        return classItem.major == this.formData.major\r\n      })\r\n    },\r\n    redirectURL(url) {\r\n      console.log(url)\r\n      window.location.href = window.location.origin + url;\r\n    },\r\n\r\n    setLoginUser() {\r\n      this.loginUser = this.getCookie('loginUser')\r\n    },\r\n\r\n    setCookie(key, value) {\r\n      Cookies.set(key, JSON.stringify(value))\r\n    },\r\n    getCookie(key) {\r\n      // console.log('IndexLogin getCookie 被调用')\r\n      let cookieValue = Cookies.get(key)\r\n      if (cookieValue == undefined) {\r\n        return null //cookie未定义\r\n      }\r\n      return JSON.parse(Cookies.get(key))\r\n    },\r\n  },\r\n  created() { },\r\n  mounted() { }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.login-app {\r\n  width: 400px;\r\n  margin: 50px auto ;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}