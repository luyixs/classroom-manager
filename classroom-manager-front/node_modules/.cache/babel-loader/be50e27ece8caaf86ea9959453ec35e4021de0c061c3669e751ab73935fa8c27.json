{"ast":null,"code":"import axios from 'axios';\nimport Cookies from 'js-cookie';\nexport default {\n  components: {},\n  props: [],\n  data() {\n    return {\n      loginUser: null\n    };\n  },\n  watch: {},\n  computed: {},\n  methods: {\n    handleOutline() {\n      axios({\n        method: 'GET',\n        url: '/login/out'\n      }).then(r => {\n        this.$message('注销成功');\n        this.setCookie('loginUser', null);\n        // this.setLoginUser()\n\n        //切换组件 给IndexLogin发送消息\n        // this.$bus.$emit('setLoginUser')\n        //刷新页面\n        location.href = location.origin;\n        console.log(this);\n      }, err => {}).finally({});\n    },\n    setLoginUser() {\n      this.loginUser = this.getCookie('loginUser');\n    },\n    setCookie(key, value) {\n      Cookies.set(key, JSON.stringify(value));\n    },\n    getCookie(key) {\n      // console.log('Avatar getCookie 被调用')\n      let cookieValue = Cookies.get(key);\n      if (cookieValue == undefined) {\n        return null; //cookie未定义\n      }\n\n      return JSON.parse(Cookies.get(key));\n    }\n  },\n  created() {},\n  mounted() {\n    this.$bus.$on('setLoginUser', this.setLoginUser);\n    this.setLoginUser();\n  },\n  beforeDestroy() {\n    this.$bus.$off('setLoginUser');\n  }\n};","map":{"version":3,"mappings":"AAgBA;AACA;AACA;EACAA;EACAC;EACAC;IACA;MACAC;IACA;EACA;EACAC;EACAC;EACAC;IACAC;MACAC;QAAAC;QAAAC;MAAA;QACA;QACA;QACA;;QAEA;QACA;QACA;QACAC;QACAC;MACA,uBACA;IACA;IAEAC;MACA;IACA;IACAC;MACAC;IACA;IACAC;MACA;MACA;MACA;QACA;MACA;;MACA;IACA;EAEA;EACAC,WACA;EACAC;IACA;IACA;EACA;EACAC;IACA;EACA;AACA","names":["components","props","data","loginUser","watch","computed","methods","handleOutline","axios","method","url","location","console","setLoginUser","setCookie","Cookies","getCookie","created","mounted","beforeDestroy"],"sourceRoot":"src/components","sources":["Avatar.vue"],"sourcesContent":["<template>\r\n  <!-- 头像盒子 -->\r\n  <el-card class=\"avatar-box\" v-if=\"null != loginUser\" >\r\n    <div>\r\n      <el-avatar :size=\"80\">{{ loginUser.name }}</el-avatar>\r\n    </div>\r\n    <div><br><span>{{ loginUser.id }}</span><br><span>{{ loginUser.role }}</span><br>\r\n      <el-link href=\"\" icon=\"el-icon-user\" :underline=\"false\">个人信息</el-link><br>\r\n      <el-button type=\"text\" @click=\"handleOutline\">注销</el-button>\r\n      <!-- <el-link th:href=\"@{/login/out}\" icon=\"el-icon-remove-outline\" :underline=\"false\">注销</el-link> -->\r\n\r\n    </div>\r\n  </el-card>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport Cookies from 'js-cookie'\r\nexport default {\r\n  components: {},\r\n  props: [],\r\n  data() {\r\n    return {\r\n      loginUser: null\r\n    };\r\n  },\r\n  watch: {},\r\n  computed: {},\r\n  methods: {\r\n    handleOutline() {\r\n      axios({ method: 'GET', url: '/login/out' }).then(r => { \r\n        this.$message('注销成功')\r\n        this.setCookie('loginUser',null)\r\n        // this.setLoginUser()\r\n\r\n        //切换组件 给IndexLogin发送消息\r\n        // this.$bus.$emit('setLoginUser')\r\n        //刷新页面\r\n        location.href= location.origin\r\n        console.log(this);\r\n      }, err => { }).finally({\r\n      })\r\n    },\r\n\r\n    setLoginUser() {\r\n      this.loginUser = this.getCookie('loginUser')\r\n    },\r\n    setCookie(key, value) {\r\n      Cookies.set(key, JSON.stringify(value))\r\n    },\r\n    getCookie(key) {\r\n      // console.log('Avatar getCookie 被调用')\r\n      let cookieValue = Cookies.get(key)\r\n      if (cookieValue == undefined) {\r\n        return null //cookie未定义\r\n      }\r\n      return JSON.parse(Cookies.get(key))\r\n    },\r\n\r\n  },\r\n  created() {\r\n  },\r\n  mounted() {\r\n    this.$bus.$on('setLoginUser', this.setLoginUser)\r\n    this.setLoginUser();\r\n  },\r\n  beforeDestroy() {\r\n    this.$bus.$off('setLoginUser')\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.avatar-box {\r\n  text-align: center;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}